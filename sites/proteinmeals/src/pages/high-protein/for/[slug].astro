---
import PersonaConditionPage from '@mealprepideas/shared/components/PersonaConditionPage.astro';
import { facets } from '@mealprepideas/shared/data/taxonomy';
import { getRecipesMatchingAnyFacet } from '@mealprepideas/shared/utils/content';

export function getStaticPaths() {
  return facets.persona.values.map(persona => ({
    params: { slug: persona },
    props: { persona },
  }));
}

const { persona } = Astro.props;
const label = persona.replace(/-/g, ' ').replace(/\b\w/g, (c: string) => c.toUpperCase());
const matchingRecipes = getRecipesMatchingAnyFacet('high-protein', 'persona', persona);
---
<PersonaConditionPage
  title={`High Protein for ${label} | ProteinMeals.co`}
  description={`High protein meal guide for ${label.toLowerCase()}. Recipes, macros, and nutrition tips tailored to your needs.`}
  conditionName={label}
  conditionType="persona"
  definition={`High protein nutrition guide tailored for ${label.toLowerCase()}. Browse curated recipes, macro breakdowns, and expert tips designed specifically for your goals.`}
  recipes={matchingRecipes.map((r, i) => ({
    id: i + 1,
    title: r.title,
    slug: r.slug,
    protein: `${r.protein}g`,
    cal: `${r.calories}`,
    tags: Object.values(r.facets).filter(Boolean) as string[],
    img: '/images/recipes/' + r.slug + '.jpg',
  }))}
/>
