---
/**
 * ThemeToggle â€” Light/Dark mode switch
 * Persists preference in localStorage.
 * Default: light mode (warm cream).
 */
---

<button
  id="theme-toggle"
  class="relative flex items-center gap-2 px-3 py-1.5 rounded-full border transition-all duration-300"
  style="border-color: var(--border-default); background: var(--bg-tertiary);"
  aria-label="Toggle theme"
  x-data="{ dark: false }"
  x-init="
    dark = localStorage.getItem('theme') === 'dark';
    document.documentElement.setAttribute('data-theme', dark ? 'dark' : 'light');
    $watch('dark', val => {
      document.documentElement.setAttribute('data-theme', val ? 'dark' : 'light');
      localStorage.setItem('theme', val ? 'dark' : 'light');
    });
  "
  @click="dark = !dark"
>
  <!-- Sun icon (light mode) -->
  <svg
    x-show="!dark"
    class="w-4 h-4"
    style="color: var(--accent-secondary);"
    fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"
  >
    <path stroke-linecap="round" stroke-linejoin="round"
      d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
  </svg>
  <!-- Moon icon (dark mode) -->
  <svg
    x-show="dark"
    class="w-4 h-4"
    style="color: var(--accent-primary);"
    fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"
  >
    <path stroke-linecap="round" stroke-linejoin="round"
      d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
  </svg>
  <span
    class="text-xs font-medium"
    style="color: var(--text-secondary);"
    x-text="dark ? 'Dark' : 'Light'"
  ></span>
</button>

<script is:inline>
  // Apply saved theme immediately on page load (before Alpine hydrates)
  // Prevents flash of wrong theme
  (function() {
    const saved = localStorage.getItem('theme');
    // Default to light if no preference saved
    const theme = saved || 'light';
    document.documentElement.setAttribute('data-theme', theme);
  })();
</script>
